class a{constructor(t={}){this.sdk=t.sdk,this.container=t.container||document.body,this.position=t.position||"bottom-right",this.size=t.size||"medium",this.theme=t.theme||"default",this.autoCheck=t.autoCheck!==!1,this.checkInterval=t.checkInterval||3e4,this.widget=null,this.isVisible=!1,this.checkIntervalId=null,this.init()}async init(){if(this.sdk&&!await this.sdk.checkPlatformEnabled()){this.sdk.debug&&console.log("âš ï¸ Voice Actions disabled at platform level. Widget will not be shown."),this.isVisible=!1;return}if(this.sdk&&this.sdk.userIdentifier&&!await this.sdk.checkUserEnabled()){this.sdk.debug&&console.log("âš ï¸ Voice Actions disabled for user. Widget will not be shown."),this.isVisible=!1;return}if(this.sdk&&!this.sdk.isInitialized&&(await this.sdk.init(),!this.sdk.isInitialized)){this.sdk.debug&&console.log("âš ï¸ SDK not initialized. Widget will not be shown."),this.isVisible=!1;return}this.createWidget(),this.attachEventListeners(),this.autoCheck&&this.startAutoCheck()}createWidget(){this.destroy(),this.widget=document.createElement("div"),this.widget.id="voice-actions-widget",this.widget.className=`voice-actions-widget voice-actions-widget-${this.position} voice-actions-widget-${this.size} voice-actions-widget-${this.theme}`;const t={position:"fixed",zIndex:"9999",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",background:this.getBackgroundColor(),border:"none",outline:"none"},i=this.getPositionStyles();Object.assign(t,i);const s=this.getSizeStyles();Object.assign(t,s),Object.assign(this.widget.style,t);const e=document.createElement("div");e.innerHTML="ðŸŽ¤",e.style.fontSize=this.getIconSize(),e.style.userSelect="none",e.style.pointerEvents="none",this.widget.appendChild(e),this.container.appendChild(this.widget),this.isVisible=!0,this.widget.addEventListener("mouseenter",()=>{this.widget.style.transform="scale(1.1)",this.widget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.2)"}),this.widget.addEventListener("mouseleave",()=>{this.widget.style.transform="scale(1)",this.widget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"})}getPositionStyles(){const t="20px";switch(this.position){case"bottom-right":return{bottom:t,right:t};case"bottom-left":return{bottom:t,left:t};case"top-right":return{top:t,right:t};case"top-left":return{top:t,left:t};default:return{bottom:t,right:t}}}getSizeStyles(){switch(this.size){case"small":return{width:"48px",height:"48px"};case"medium":return{width:"64px",height:"64px"};case"large":return{width:"80px",height:"80px"};default:return{width:"64px",height:"64px"}}}getIconSize(){switch(this.size){case"small":return"24px";case"medium":return"32px";case"large":return"40px";default:return"32px"}}getBackgroundColor(){switch(this.theme){case"dark":return"linear-gradient(135deg, #667eea 0%, #764ba2 100%)";case"light":return"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)";default:return"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}attachEventListeners(){!this.widget||!this.sdk||(this.widget.addEventListener("click",async()=>{if(this.sdk.userIdentifier&&!await this.sdk.checkUserEnabled()){alert("Voice Actions is disabled. Please enable it in your settings.");return}if(!this.sdk.isInitialized&&(await this.sdk.init(),!this.sdk.isInitialized)){alert("Voice Actions is not available. Please check your settings.");return}if(this.sdk.isListening)this.sdk.stop(),this.updateWidgetState(!1);else try{await this.sdk.start(),this.updateWidgetState(!0)}catch(t){console.error("Failed to start voice recognition:",t),alert("Failed to start voice recognition: "+t.message)}}),this.sdk&&setInterval(()=>{this.sdk&&this.sdk.isListening!==this.isListening&&this.updateWidgetState(this.sdk.isListening)},500))}updateWidgetState(t){if(this.widget)if(this.isListening=t,t){if(this.widget.style.background="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",this.widget.style.animation="pulse 2s infinite",!document.getElementById("voice-actions-widget-styles")){const i=document.createElement("style");i.id="voice-actions-widget-styles",i.textContent=`
          @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
          }
        `,document.head.appendChild(i)}}else this.widget.style.background=this.getBackgroundColor(),this.widget.style.animation="none"}async startAutoCheck(){this.sdk&&(await this.checkUserSettings(),this.checkIntervalId=setInterval(async()=>{await this.checkUserSettings()},this.checkInterval))}async checkUserSettings(){if(this.sdk)try{if(!await this.sdk.checkPlatformEnabled()){this.isVisible&&this.hide(),this.sdk&&this.sdk.isListening&&this.sdk.stop();return}this.sdk.userIdentifier?await this.sdk.checkUserEnabled()?(this.sdk.isInitialized||await this.sdk.init(),this.sdk.isInitialized&&!this.isVisible&&this.show()):(this.isVisible&&this.hide(),this.sdk&&this.sdk.isListening&&this.sdk.stop()):(this.sdk.isInitialized||await this.sdk.init(),this.sdk.isInitialized&&!this.isVisible&&this.show())}catch(t){console.error("Error checking settings:",t)}}async show(){this.isVisible||this.sdk&&(!await this.sdk.checkPlatformEnabled()||this.sdk.userIdentifier&&!await this.sdk.checkUserEnabled()||!this.sdk.isInitialized&&(await this.sdk.init(),!this.sdk.isInitialized))||(this.widget?(this.widget.style.display="flex",this.isVisible=!0):this.createWidget())}hide(){!this.isVisible||!this.widget||(this.widget.style.display="none",this.isVisible=!1,this.sdk&&this.sdk.isListening&&this.sdk.stop())}destroy(){this.checkIntervalId&&(clearInterval(this.checkIntervalId),this.checkIntervalId=null),this.widget&&this.widget.parentNode&&this.widget.parentNode.removeChild(this.widget),this.widget=null,this.isVisible=!1}}export{a as default};
